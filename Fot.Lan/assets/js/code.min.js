"use strict";var bundle=null,instructionTemplate=null,starterTemplate=null,assessmentTemplate=null,essayTemplate=null,essayStarterTemplate=null,assessmentEndTemplate=null,assessmentSelectionTemplate=null;$(function(){$("#img").show();$("#img").css("display","block");var n=$("#loader").data("request-url-get-test");$.get(n).done(function(n){if(bundle=n,bundle.flagsuccess===!0)bundle.current_assessment_index<0&&bundle.allow_assessment_selection===!1&&(bundle.current_assessment_index=0),bundle.candidate_photo!==null&&$("#imgCandidate").prop("src","data:image/png;base64, "+bundle.candidate_photo),bundle.current_assessment_index>=0&&bundle.assessments[bundle.current_assessment_index].started?instructionPage.moveNext():($("#img").prop("src","data:image/png;base64,"+bundle.bundle_icon),$("#bttn").show());else{var t="<h1> "+bundle.error_message+"<\/h1>";$("#content").html(t)}});instructionTemplate=Handlebars.compile($("#instruction").html());starterTemplate=Handlebars.compile($("#starter").html());assessmentTemplate=Handlebars.compile($("#assessment").html());essayTemplate=Handlebars.compile($("#essay").html());essayStarterTemplate=Handlebars.compile($("#essayStarter").html());assessmentEndTemplate=Handlebars.compile($("#assessmentEnd").html());assessmentSelectionTemplate=Handlebars.compile($("#assessmentSelection").html())});var firstPage=function(){var n=function(){var n="",t,u;bundle.allow_assessment_selection?bundle.current_assessment_index<0?(t=i(),t>=0?(bundle.current_assessment_index=t,n=instructionTemplate(bundle.assessments[bundle.current_assessment_index])):(u={assessments_table:r()},n=assessmentSelectionTemplate(u))):n=instructionTemplate(bundle.assessments[bundle.current_assessment_index]):n=instructionTemplate(bundle.assessments[bundle.current_assessment_index]);$("#container").html(n)},t=function(t){for(var i=0;i<bundle.assessments.length;i++)if(bundle.assessments[i].assessment_id===t){bundle.current_assessment_index=i;n();break}},i=function(){for(var t=0,i=-1,n=0;n<bundle.assessments.length;n++)bundle.assessments[n].completed===!1&&(t++,i=n);return t===1?i:-1},r=function(){for(var i,t='<table class="table table-bordered table-hover table-striped"><tbody><tr><th>Assessment<\/th><th style="width: 140px;">&nbsp;<\/th><\/tr>',n=0;n<bundle.assessments.length;n++)bundle.assessments[n].completed===!1&&(i="<tr><td>"+bundle.assessments[n].assessment_name+"<\/td><td><button class='btn btn-default navButton' onclick='firstPage.selectAssessment("+bundle.assessments[n].assessment_id+")'>Start Test<\/button><\/td> <\/tr>",t+=i);return t+"<\/tbody><\/table>"};return{moveNext:n,selectAssessment:t}}(),instructionPage=function(){var n=function(){var o=bundle.assessments[bundle.current_assessment_index].timed,s=bundle.assessments[bundle.current_assessment_index].duration,e="",h=bundle.assessments[bundle.current_assessment_index].assessment_name,t="",i,c,r,l,f,u,n;if(bundle.assessments[bundle.current_assessment_index].assessment_type==="MCQ"?(i="",t="Start Test",o===!0?bundle.assessments[bundle.current_assessment_index].started===!0?(i="You have started this assessment previously and you have "+bundle.assessments[bundle.current_assessment_index].time_remaining+" minutes left to complete it. The timer will continue when you click on 'Continue Test' .",t="Continue Test"):i="You will have "+s+" minutes to work on this test. The timer will start when you click on 'Start Test' .":i="You have no time limit on this assesment. You may click on 'Start Test' to begin.",c={assessment_name:h,message:i,btn_text:t},e=starterTemplate(c)):(r="",t="Start Test",o===!0?bundle.assessments[bundle.current_assessment_index].started===!0?(r="You have started this assessment previously and you have "+bundle.assessments[bundle.current_assessment_index].time_remaining+" minutes left to complete it. The timer will continue when you click on 'Continue Test' .",t="Continue Test"):r="You will have "+s+" minutes to work on this test. The timer will start when you click on 'Start Test'. Select your preferred essay topic from the list below.":r="You have no time limit on this assesment. You may click on 'Start Test' to begin.",l={assessment_name:h,message:r,btn_text:t},e=essayStarterTemplate(l)),$("#container").html(e),bundle.assessments[bundle.current_assessment_index].assessment_type!=="MCQ"){for(f="",u="",n=0;n<bundle.assessments[bundle.current_assessment_index].essays.length;n++)bundle.assessments[bundle.current_assessment_index].essays[n].selected?(f+="<option value='"+n+"' selected>Topic "+(n+1)+" <\/option>",u=bundle.assessments[bundle.current_assessment_index].essays[n].topic):f+="<option value='"+n+"'>Topic "+(n+1)+" <\/option>";$("#listTopics").html(f);u!==""&&$("#listTopics").prop("disabled",!0);$("#divTopic").html(u===""?bundle.assessments[bundle.current_assessment_index].essays[0].topic:u)}};return{moveNext:n}}(),starterPage=function(){var t=function(){var i=bundle.assessments[bundle.current_assessment_index].assessment_name,t=bundle.assessments[bundle.current_assessment_index].questions;bundle.assessments[bundle.current_assessment_index].started?bundle.assessments[bundle.current_assessment_index].timed&&(bundle.assessments[bundle.current_assessment_index].duration=bundle.assessments[bundle.current_assessment_index].time_remaining):(bundle.assessments[bundle.current_assessment_index].current_question_index=0,bundle.assessments[bundle.current_assessment_index].questions[0].seen=!0);var r="Question "+(bundle.assessments[bundle.current_assessment_index].current_question_index+1)+" of "+t.length,u=t[bundle.assessments[bundle.current_assessment_index].current_question_index].item_img,f=t[bundle.assessments[bundle.current_assessment_index].current_question_index].question_text,e=n(t[bundle.assessments[bundle.current_assessment_index].current_question_index]),o={assessment_name:i,question_count:r,item_img:u,question_text:f,question_options:e},s=assessmentTemplate(o);$("#container").html(s);bundle.assessments[bundle.current_assessment_index].show_calculator===!0?$("#divShowCalculator").show():$("#divShowCalculator").hide();assessmentPage.init()},n=function(n){for(var r,u=bundle.assessments[bundle.current_assessment_index].current_question_index,i=[],e="",f=["A","B","C","D","E","F","G","H","I","J"],t=0;t<n.answers.length;t++)r=n.answers[t].selected?"checked":"",n.options_layout_is_vertical===!0?n.answer_type==="Single"?n.answers[t].is_image===!0?i.push('<div class="radio"><span style="margin-right: 20px;font-weight: bold; color: #666;">[',f[t],']<\/span><label><input type="radio" name="',n.question_id,'" id="',u+"_"+t,'" value="',t,'" ',r,' onclick="assessmentPage.saveRadioState(this)">','<img src="data:image/png;base64,',n.answers[t].answer_image,'" style="max-height: 90px;" />',"<\/label><\/div>"):i.push('<div class="radio"><span style="margin-right: 20px;font-weight: bold; color: #666;">[',f[t],']<\/span><label><input type="radio" name="',n.question_id,'" id="',u+"_"+t,'" value="',t,'" ',r,' onclick="assessmentPage.saveRadioState(this)">',n.answers[t].answer_text,"<\/label><\/div>"):n.answers[t].is_image===!0?i.push('<div class="checkbox"><span style="margin-right: 20px;font-weight:bold; color: #666;">[',f[t],']<\/span><label><input type="checkbox" id="',u+"_"+t,'"  value="',t,'" ',r,' onclick="assessmentPage.saveCheckBoxState(this)">','<img src="data:image/png;base64,',n.answers[t].answer_image,'" style="max-height: 90px;" />',"<\/label><\/div>"):i.push('<div class="checkbox"><span style="margin-right: 20px;font-weight:bold; color: #666;">[',f[t],']<\/span><label><input type="checkbox" id="',u+"_"+t,'"  value="',t,'" ',r,' onclick="assessmentPage.saveCheckBoxState(this)">',n.answers[t].answer_text,"<\/label><\/div>"):n.answer_type==="Single"?n.answers[t].is_image===!0?i.push('<label class="radio-inline">','<span style="margin-right: 20px;font-weight: bold; color: #666;">[',f[t],"]<\/span>",'<input type="radio" name="',n.question_id,'" id="',u+"_"+t,'" value="',t,'" ',r,' onclick="assessmentPage.saveRadioState(this)">','<img src="data:image/png;base64,',n.answers[t].answer_image,'" style="max-height: 90px;" />',"<\/label>"):i.push('<label class="radio-inline">','<span style="margin-right: 20px;font-weight: bold; color: #666;">[',f[t],"]<\/span>",'<input type="radio" name="',n.question_id,'" id="',u+"_"+t,'" value="',t,'" ',r,' onclick="assessmentPage.saveRadioState(this)">',n.answers[t].answer_text,"<\/label>"):n.answers[t].is_image===!0?i.push('<label class="checkbox-inline">','<span style="margin-right: 20px;font-weight:bold; color: #666;">[',f[t],"]<\/span>",'<input type="checkbox" id="',u+"_"+t,'"  value="',t,'" ',r,' onclick="assessmentPage.saveCheckBoxState(this)">','<img src="data:image/png;base64,',n.answers[t].answer_image,'" style="max-height: 90px;" />',"<\/label>"):i.push('<label class="checkbox-inline">','<span style="margin-right: 20px;font-weight:bold; color: #666;">[',f[t],"]<\/span>",'<input type="checkbox" id="',u+"_"+t,'"  value="',t,'" ',r,' onclick="assessmentPage.saveCheckBoxState(this)">',n.answers[t].answer_text,"<\/label>");return e=i.join(""),n.options_layout_is_vertical===!1&&(e='<div style="padding-top: 20px;">'+e+"<\/div>"),e};return{startTest:t,getOptions:n}}(),essayStarterPage=function(){var n=function(){var i=bundle.assessments[bundle.current_assessment_index].assessment_name,n=bundle.assessments[bundle.current_assessment_index].essays;bundle.assessments[bundle.current_assessment_index].started?bundle.assessments[bundle.current_assessment_index].timed&&(bundle.assessments[bundle.current_assessment_index].duration=bundle.assessments[bundle.current_assessment_index].time_remaining):(bundle.assessments[bundle.current_assessment_index].current_question_index=parseInt($("#listTopics").val()),n[bundle.assessments[bundle.current_assessment_index].current_question_index].selected=!0);var r=n[bundle.assessments[bundle.current_assessment_index].current_question_index].topic,t=n[bundle.assessments[bundle.current_assessment_index].current_question_index].candidate_response,u={assessment_name:i,topic:r,candidate_response:t},f=essayTemplate(u);$("#container").html(f);t.length>0&&essayPage.countWords(t);$("#editor").kendoEditor({change:function(){essayPage.countWords(this.value())},keyup:function(){essayPage.countWords(this.value())}});essayPage.init()},t=function(){var n=parseInt($("#listTopics").val());$("#divTopic").html(bundle.assessments[bundle.current_assessment_index].essays[n].topic)};return{startTest:n,changeTopic:t}}(),assessmentPage=function(){function y(){var i,r,u,f,o,s,c;if(n<=0&&t<=0){bundle.assessments[bundle.current_assessment_index].started===!0&&e();return}if(t===0){for(t=60,n>0&&n--,bundle.assessments[bundle.current_assessment_index].time_remaining=n,i=JSON.parse(JSON.stringify(bundle)),i.bundle_name="",i.bundle_icon="",i.candidate_photo="",r=0;r<i.assessments.length;r++)if(i.assessments[r].assessment_name="",i.assessments[r].instruction_image="",i.assessments[r].assessment_type==="MCQ")for(u=0;u<i.assessments[r].questions.length;u++)for(i.assessments[r].questions[u].item_img="",i.assessments[r].questions[u].question_text="",f=0;f<i.assessments[r].questions[u].answers.length;f++)i.assessments[r].questions[u].answers[f].answer_image="",i.assessments[r].questions[u].answers[f].answer_text="";else for(o=0;o<i.assessments[r].essays.length;o++)i.assessments[r].essays[o].topic="";s={bundle:i};c=$("#saver").data("request-url-save-test");$.ajax({url:c,data:JSON.stringify(s),type:"POST",contentType:"application/json",dataType:"json",timeout:5e3}).done(function(){$("#spanNever").hide();$("#spanTime").show();$("time#timeSaved").timeago("update",(new Date).toISOString())}).fail(function(){})}h(n,--t)}function e(){bundle.assessments[bundle.current_assessment_index].timed&&clearInterval(u);$("#divShowCalculator").hide();$("#spanNever").show();$("#spanTime").hide();$("#divSaved").hide();bundle.assessments[bundle.current_assessment_index].completed=!0;var i="";bundle.allow_assessment_selection?p()===0?($("body").off("keyup"),i=assessmentEndTemplate(bundle),$("#container").html(i),assessmentEndPage.submitAssessment()):(bundle.current_assessment_index=-1,n=0,t=0,firstPage.moveNext()):bundle.current_assessment_index===bundle.assessments.length-1?($("body").off("keyup"),i=assessmentEndTemplate(bundle),$("#container").html(i),assessmentEndPage.submitAssessment()):(bundle.current_assessment_index++,n=0,t=0,firstPage.moveNext())}function p(){for(var t=0,n=0;n<bundle.assessments.length;n++)bundle.assessments[n].completed===!1&&t++;return t}function s(n){n===!0?($("#divQuestionCount").hide(),$("#divQuestion").hide(),$("#divAdditional").hide(),$("#divOptions").hide(),$("#bttnNext").hide(),$("#navDiv").hide()):($("#divQuestionCount").show(),$("#divQuestion").show(),$("#divAdditional").show(),$("#divOptions").show(),$("#bttnNext").show(),$("#navDiv").show())}function k(){s(!0);$("#divEnd").show();$("#bttnEnd").show();i=!0}function h(n,t){var f=n,e=0,o=f,i,r,u;f>=60&&(e=parseInt(f/60),o=f%60);i=e+"";r=o+"";t===60&&(t=0);u=t+"";u.length===1&&(u="0"+u);i.length===1&&(i="0"+i);r.length===1&&(r="0"+r);$("#divTimer").text(i+":"+r+":"+u)}function r(n){$("#item_img").prop("src","data:image/png;base64,"+bundle.assessments[bundle.current_assessment_index].questions[n].item_img);$("#divAdditional").text(bundle.assessments[bundle.current_assessment_index].questions[n].question_text);$("#divQuestionCount").text("Question "+(n+1)+" of "+bundle.assessments[bundle.current_assessment_index].questions.length);bundle.assessments[bundle.current_assessment_index].questions[n].seen=!0;bundle.assessments[bundle.current_assessment_index].current_question_index=n;var t=starterPage.getOptions(bundle.assessments[bundle.current_assessment_index].questions[n]);$("#divOptions").html(t);bundle.assessments[bundle.current_assessment_index].current_question_index===0?$("#bttnPrevious").hide():$("#bttnPrevious").show();f()}var i=!1,u,t=0,n=0,l=function(){$("#bttnPrevious").hide();bundle.assessments[bundle.current_assessment_index].timed?(n=bundle.assessments[bundle.current_assessment_index].duration,h(n,0),u=setInterval(y,1e3),$("#divTimerWrapper").show()):$("#divTimerWrapper").hide();bundle.assessments[bundle.current_assessment_index].started?r(bundle.assessments[bundle.current_assessment_index].current_question_index):bundle.assessments[bundle.current_assessment_index].started=!0;f();$("body").on("keyup",function(n){n.keyCode===39&&i===!1?o():n.keyCode===37&&bundle.assessments[bundle.current_assessment_index].current_question_index>0?c():n.keyCode>=65&&n.keyCode<=74&&bundle.assessments[bundle.current_assessment_index].current_question_index>=0&&i===!1&&a(bundle.assessments[bundle.current_assessment_index].current_question_index,v(n.keyCode))});$("#divSaved").show();$("time.timeago").timeago()},a=function(n,t){var i=$("#"+n+"_"+t),r;i&&(r=$(i).prop("type"),r==="radio"?$(i).prop("checked",!0).trigger("click"):$(i).click())},v=function(n){var t=0;switch(n){case 65:t=0;break;case 66:t=1;break;case 67:t=2;break;case 68:t=3;break;case 69:t=4;break;case 70:t=5;break;case 71:t=6;break;case 72:t=7;break;case 73:t=8;break;case 74:t=9}return t},f=function(){for(var t,i,u,f=bundle.assessments[bundle.current_assessment_index].current_question_index,r=[],n=0;n<bundle.assessments[bundle.current_assessment_index].questions.length;n++)t=n+1,i="<li><a href='javascript:void(0)' onclick='assessmentPage.moveTo("+n+");'> "+t+"<\/a><\/li>",n===f?i="<li class='active'><a href='javascript:void(0)'> "+t+"<\/a><\/li>":(bundle.assessments[bundle.current_assessment_index].questions[n].seen===!0&&(i="<li><a href='javascript:void(0)' onclick='assessmentPage.moveTo("+n+");' style='background-color: #fb9494;color: #000;'> "+t+"<\/a><\/li>"),bundle.assessments[bundle.current_assessment_index].questions[n].answered===!0&&(i="<li><a href='javascript:void(0)' onclick='assessmentPage.moveTo("+n+");' style='background-color: #a0eb9d;color: #333;'> "+t+"<\/a><\/li>")),r.push(i);u="<ul class='pagination' style='margin: 0;'>"+r.join("")+"<\/ul>";$("#navDiv").html(u)},w=function(){confirm("Are you sure you want to end the assessment ?")&&bundle.assessments[bundle.current_assessment_index].started===!0&&e()},b=function(n){r(n)},o=function(){bundle.assessments[bundle.current_assessment_index].current_question_index<bundle.assessments[bundle.current_assessment_index].questions.length-1?(r(++bundle.assessments[bundle.current_assessment_index].current_question_index),bundle.assessments[bundle.current_assessment_index].current_question_index>0&&$("#bttnPrevious").show()):k()},c=function(){i===!0?(s(!1),r(bundle.assessments[bundle.current_assessment_index].current_question_index),i=!1,$("#divEnd").hide(),$("#bttnEnd").hide()):(r(--bundle.assessments[bundle.current_assessment_index].current_question_index),bundle.assessments[bundle.current_assessment_index].current_question_index===0&&$("#bttnPrevious").hide())},d=function(n){var i,t;if(n.checked){for(i=parseInt($(n).val()),t=0;t<bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers.length;t++)bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers[t].selected=!1;bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers[i].selected=!0;bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answered=!0}},g=function(n){var i=parseInt($(n).val()),t;for(bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers[i].selected=n.checked,t=0;t<bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers.length;t++){if(bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answers[t].selected===!0){bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answered=!0;break}bundle.assessments[bundle.current_assessment_index].questions[bundle.assessments[bundle.current_assessment_index].current_question_index].answered=!1}};return{moveNext:o,movePrevious:c,doEnd:w,init:l,saveRadioState:d,saveCheckBoxState:g,moveTo:b}}(),essayPage=function(){function o(){var i,e,o,s,h;if(n<=0&&t<=0){bundle.assessments[bundle.current_assessment_index].started===!0&&r();return}if(t===0){for(t=60,n>0&&n--,bundle.assessments[bundle.current_assessment_index].time_remaining=n,u(),i=JSON.parse(JSON.stringify(bundle)),i.bundle_name="",i.bundle_icon="",i.candidate_photo="",e=0;e<i.assessments.length;e++)if(i.assessments[e].assessment_name="",i.assessments[e].instruction_image="",i.assessments[e].assessment_type!=="MCQ")for(o=0;o<i.assessments[e].essays.length;o++)i.assessments[e].essays[o].topic="";s={bundle:i};h=$("#saver").data("request-url-save-test");$.ajax({url:h,data:JSON.stringify(s),type:"POST",contentType:"application/json",dataType:"json",timeout:5e3}).done(function(){$("#spanNever").hide();$("#spanTime").show();$("time#timeSaved").timeago("update",(new Date).toISOString())}).fail(function(){})}f(n,--t)}function r(){bundle.assessments[bundle.current_assessment_index].timed&&clearInterval(i);$("#spanNever").show();$("#spanTime").hide();$("#divSaved").hide();bundle.assessments[bundle.current_assessment_index].completed=!0;u();var r="";bundle.allow_assessment_selection?s()===0?($("body").off("keyup"),r=assessmentEndTemplate(bundle),$("#container").html(r),assessmentEndPage.submitAssessment()):(bundle.current_assessment_index=-1,n=0,t=0,firstPage.moveNext()):bundle.current_assessment_index===bundle.assessments.length-1?($("body").off("keyup"),r=assessmentEndTemplate(bundle),$("#container").html(r),assessmentEndPage.submitAssessment()):(bundle.current_assessment_index++,n=0,t=0,firstPage.moveNext())}function s(){for(var t=0,n=0;n<bundle.assessments.length;n++)bundle.assessments[n].completed===!1&&t++;return t}function f(n,t){var f=n,e=0,o=f,i,r,u;f>=60&&(e=parseInt(f/60),o=f%60);i=e+"";r=o+"";t===60&&(t=0);u=t+"";u.length===1&&(u="0"+u);i.length===1&&(i="0"+i);r.length===1&&(r="0"+r);$("#divTimer").text(i+":"+r+":"+u)}var i,t=0,n=0,e=function(){bundle.assessments[bundle.current_assessment_index].timed?(n=bundle.assessments[bundle.current_assessment_index].duration,f(n,0),i=setInterval(o,1e3),$("#divTimerWrapper").show()):$("#divTimerWrapper").hide();bundle.assessments[bundle.current_assessment_index].started||(bundle.assessments[bundle.current_assessment_index].started=!0);$("#divSaved").show();$("time.timeago").timeago()},u=function(){var t=$("#editor").data("kendoEditor"),i=t.value(),n=bundle.current_assessment_index;bundle.assessments[n].essays[bundle.assessments[n].current_question_index].candidate_response=i},h=function(){confirm("Are you sure you want to end this assessment ?")&&bundle.assessments[bundle.current_assessment_index].started===!0&&r()},c=function(n){var t=n,i;t=t.replace(/(^\s*)|(\s*$)/gi,"");t=t.replace(/[ ]{2,}/gi," ");t=t.replace(/\n /,"\n");i=t.split(" ").length;$("#txtWords").text(i+(i===1?" WORD":" WORDS"))};return{countWords:c,doEnd:h,init:e}}(),assessmentEndPage=function(){function i(n){for(var i=0,t=0;t<n.length;t++)i+=n[t].Score;return i}function r(n){for(var u,i='<table class="table table-bordered table-hover table-striped"><tbody><tr><th>Assessment<\/th><th style="width: 140px;">Score<\/th><\/tr>',r=0,t=0;t<n.length;t++)u="<tr><td>"+n[t].AssessmentName+"<\/td><td>"+n[t].Score+"<\/td> <\/tr>",i+=u,r+=n[t].Score;return i+="<tr><th>Aggregate<\/th><th>"+r+"<\/th> <\/tr>",i+"<\/tbody><\/table>"}function n(n){for(var t=0;t<n.essays.length;t++)if(n.essays[t].selected)return n.essays[t].candidate_response}function u(n){for(var t=0;t<n.essays.length;t++)if(n.essays[t].selected)return n.essays[t].essay_id}function f(n){for(var f,t,r,u="",i=0;i<n.questions.length;i++){for(f=n.questions[i].question_id+"",t="",r=0;r<n.questions[i].answers.length;r++)n.questions[i].answers[r].selected&&(t.length>0&&(t+=","),t+=n.questions[i].answers[r].answer_id+"");t.length===0&&(t="0");u.length>0&&(u+=";");u+=f+":"+t}return u}var t=function(){var e,t,o,s;for($("#divProgress").show(),$("#bttnResend").hide(),e=[],t=0;t<bundle.assessments.length;t++)bundle.assessments[t].assessment_type==="MCQ"?e.push({assessment_id:bundle.assessments[t].assessment_id,result:f(bundle.assessments[t])}):e.push({assessment_id:bundle.assessments[t].assessment_id,is_essay:!0,essay_id:u(bundle.assessments[t]),result:n(bundle.assessments[t])});o={responses:e};s=$("#submitter").data("request-url-submit-test");$.ajax({url:s,data:JSON.stringify(o),type:"POST",contentType:"application/json",dataType:"json"}).done(function(n){if(n.Succeeded===!0){if($("#divStatus").html('<div class="alert alert-success alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;<\/button>Assessment submitted successfully.<\/div>'),$("#divProgress").hide(),bundle.show_results_on_submit===!0&&n.resultList.length>0&&($("#divResult").show(),$("#divResult").html(r(n.resultList))),bundle.min_aggregate_score!==null){var t=i(n.resultList);$("#lblPassFail").show();$("#lblPassFail").html(t>=bundle.min_aggregate_score?"<strong style='color: green; font-size: 18px;'>Congratulations. You were successful at this stage.<\/strong>":"<strong style='color: red; font-size: 18px;'>Sorry, your attempt was not successful.<\/strong>")}bundle.show_feedback?showFeedback():$("#divFeedbackButton").show()}else $("#divProgress").hide(),$("#bttnResend").show(),$("#divStatus").html('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;<\/button><strong>Error!<\/strong> '+n.ErrorMessage+'. Please click on "Submit Test" below.<\/div>')}).fail(function(){$("#divProgress").hide();$("#bttnResend").show();$("#divStatus").html('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;<\/button><strong>Error!<\/strong> Could not submit test. Please click on "Submit Test" below.<\/div>')})};return{submitAssessment:t,getEssayResponse:n}}();